# Диоген

Система для поиска на изображении грузовых ТС и чтения их автомобильных номеров.

# Обучение

Для работы системы нужны обученные модели. Эти модели должны находиться в директории `models`. Можно либо воспользоваться готовыми моделями, либо обучить их самому. 

Для вторых целей есть программы `scripts/train_plate_detector.py` и `scripts/train_plate_reader.py`. Обе программы можно запустить, передав ключ `--help`, для получения списка возможных аргументов.

Первая из них позволяет обучить модель для детекции автомобильных номеров. Обучающие данные должны находиться в директории `data/carplates_yolo`. В результате обучения модель будет сохранена в `runs/detect/trainN/weights/best.pt`.

Вторая программа обучает модель для чтения вырезанных автомобильных номеров. Обучающие данные должны находиться в директории `data/plates_cropped`. В результате обучения модель будет сохранена в `train_crnn/best.pt`.

# Использование

Для работы необходимы обученные модели, т.е. файлы с весами, хранящиеся в директории `models`:

1. Стандартная `yolo11l.pt` для детекции грузовых ТС.

2. Обученная `yolo11s-plates.pt` для детекции автомобильных номеров. После обучения необходимо вручную перенести из `runs/detect/trainN/weights/best.pt`.

2. Обученная `crnn-plates.pt` для чтения автомобильного номера. После обучения необходимо вручную перенести из `train_crnn/best.pt`.

Также файлы с весами могут быть получены во вкладке Releases на GitHub.

Является сервисом. Документацию к нему можно получить по адресу `127.0.0.1:[port]/docs`.

```
usage: start_server.py [-h] [-H HOST] -p PORT [-w WORKERS] [-a]

Программа позволяет найти на изображении грузовики и прочитать их автомобильный номер

options:
  -h, --help            show this help message and exit
  -H HOST, --host HOST  Адрес сервиса. (default: 127.0.0.1)
  -p PORT, --port PORT  Порт сервиса. (default: None)
  -w WORKERS, --workers WORKERS
                        Количество обработчиков запросов. (default: 1)
  -a, --use-accelerator
                        Использовать ли ускоритель, если он доступен. (default: False)
```